import{a as B}from"./chunk-JRYIPAML.js";import{a as D}from"./chunk-KH7O47GI.js";import{$a as y,Ca as r,Cc as k,Da as p,Db as a,Dc as E,Eb as d,Fb as c,Mb as b,Ob as m,Qb as S,Ta as w,Tb as f,Ub as I,Va as l,Vb as R,Z as C,eb as i,fb as o,gb as u,hc as M,nb as _,nc as T,oc as O,pc as P,ya as x}from"./chunk-E3Q76OLE.js";var v=s=>["/tour",s],z=(s,h,t)=>({"fa-heart":!0,"text-danger":s,"fa-regular":h,"fa-solid":t});function A(s,h){s&1&&(i(0,"span",6),a(1,"featured"),o())}var U=(()=>{class s{constructor(t,n,e){this._DataService=t,this.toaster=n,this._Router=e,this.layoutType="grid",this.favs=[],this.favouriteIds=[],this.alltours=[],this.tourReviews=[]}ngOnInit(){if(typeof window<"u"&&typeof localStorage<"u"){let t=localStorage.getItem("favouriteIds");this.favouriteIds=t?JSON.parse(t):[]}else console.warn("localStorage is not available (probably SSR mode)");this.tour?.id&&this.getTourReviews()}addFav(t,n){if(n.stopPropagation(),!localStorage.getItem("accessToken")){this.toaster.error("You must have an account"),this._Router.navigate(["/login"]);return}this._DataService.toggleWishlist(t).subscribe({next:e=>{if(localStorage.getItem("accessToken")){this.favs=e;let g=this.favouriteIds.indexOf(t);g>-1?this.favouriteIds.splice(g,1):this.favouriteIds.push(t),localStorage.setItem("favouriteIds",JSON.stringify(this.favouriteIds))}else this.toaster.error("You must have an account ")},error:e=>{this.toaster.error(e.error.message)}})}getTourReviews(){this.tour?.id&&this._DataService.getReviews(this.tour.id).subscribe({next:t=>{this.tourReviews=t.data.data||[]},error:t=>{console.error("Error fetching reviews:",t),this.tourReviews=[]}})}getAverageRating(){return this.tourReviews.length===0?this.tour?.rate||0:this.tourReviews.reduce((n,e)=>n+(e.rate||0),0)/this.tourReviews.length}getReviewQualityText(){if((this.tourReviews.length||this.tour?.reviews_number||0)===0)return"New Tour";let n=this.getAverageRating();return n>=4.5?"Excellent":n>=4?"Very Good":n>=3.5?"Good":n>=3?"Average":n>0?"Below Average":"No Rating"}getReviewCount(){return this.tourReviews.length||this.tour?.reviews_number||0}getDestinationText(){return this.tour?.destinationsTitle?this.tour.destinationsTitle:this.tour?.destinations&&Array.isArray(this.tour.destinations)&&this.tour.destinations.length>0?this.tour.destinations.map(t=>t.title).join(", "):"Destination not specified"}static{this.\u0275fac=function(n){return new(n||s)(p(D),p(B),p(k))}}static{this.\u0275cmp=C({type:s,selectors:[["app-tour-cart"]],inputs:{layoutType:"layoutType",tour:"tour"},standalone:!0,features:[b],decls:42,vars:34,consts:[["role","button",1,"item","overflow-hidden","sideBar","transition",3,"routerLink","ngClass"],[1,"px-0",3,"ngClass"],[1,"mb-0","overflow-hidden","position-relative"],["height","200px","loading","lazy",1,"w-100",3,"src","alt","title"],[1,"mainBtn","Btn","position-absolute","bottom-0","start-0","p-2",3,"click"],[1,"fa","fa-heart","text-white","bg-transparent","border-0",3,"ngClass"],[1,"text-uppercase","text-white","py-0","px-2","m-1","me-3","mainBtn","Btn","position-absolute","top-0","end-0"],[1,"",3,"ngClass"],[1,"p-2"],[1,"flexBetween","text-capitalize"],[1,"fa","fa-tag","me-1","textMainColor"],[1,"textSecondColor"],[1,"h4","text-capitalize","transition","cPointer",3,"routerLink"],["href","",1,""],[1,"fa","fa-location-dot","me-1","textMainColor"],[1,"my-2"],[1,"rateBox","text-white","p-1"],[1,"fa-regular","fa-star","me-1"],[1,"textMainColor","text-capitalize","mx-2"],[1,"mb-3"],[1,"fa","fa-clock-four","me-1","textMainColor"],[1,"textSecondColor","py-2","border-top","flexBetween","text-capitalize"],[1,"textThirdColor"],[3,"routerLink"],[1,"fa","fa-arrow-right","ms-1"]],template:function(n,e){n&1&&(i(0,"div",0)(1,"div",1)(2,"figure",2),u(3,"img",3),i(4,"button",4),_("click",function(F){return e.addFav(e.tour.id,F)}),u(5,"i",5),o(),w(6,A,2,0,"span",6),o()(),i(7,"div",7)(8,"figcaption",8)(9,"div",9)(10,"div"),u(11,"i",10),i(12,"span",11),a(13),o()()(),i(14,"h3",12),a(15),o(),i(16,"a",13),u(17,"i",14),i(18,"span",11),a(19),o()(),i(20,"div",15)(21,"span",16),u(22,"i",17),a(23),f(24,"number"),o(),i(25,"span",18),a(26),o(),i(27,"span",11),a(28),o()(),i(29,"div",19),u(30,"i",20),i(31,"span",11),a(32),o()(),i(33,"div",21)(34,"span"),a(35,"from "),i(36,"b",22),a(37),f(38,"currency"),o()(),i(39,"span",23),a(40,"see more "),u(41,"i",24),o()()()()()),n&2&&(l("routerLink",m(24,v,e.tour.slug))("ngClass",e.layoutType==="grid"?"row gx-3 flex-column":"row gx-3 flex-wrap"),r(),l("ngClass",e.layoutType==="grid"?"":" col-md-5"),r(2),l("src",e.tour.featured_image,x)("alt",e.tour.title)("title",e.tour.title),r(2),l("ngClass",S(26,z,e.favouriteIds.includes(e.tour.id),!e.favouriteIds.includes(e.tour.id),e.favouriteIds.includes(e.tour.id))),r(),y(6,e.tour.featured?6:-1),r(),l("ngClass",e.layoutType==="grid"?"":" col-md-7"),r(6),d(e.tour.type),r(),l("routerLink",m(30,v,e.tour.slug)),r(),c(" ",e.tour.title," "),r(4),d(e.getDestinationText()),r(4),c(" ",R(24,19,e.getAverageRating(),"1.1-1")," "),r(3),d(e.getReviewQualityText()),r(2),c(" (",e.getReviewCount()," Reviews)"),r(4),d(e.tour.duration),r(5),d(I(38,22,e.tour.start_from)),r(2),l("routerLink",m(32,v,e.tour.slug)))},dependencies:[E,P,M,T,O],styles:[".item[_ngcontent-%COMP%]{border-radius:40px 40px 40px 0}.item[_ngcontent-%COMP%]:hover{transform:translateY(5px) scale(1.01)}.item[_ngcontent-%COMP%]   figure[_ngcontent-%COMP%]{border-radius:40px 40px 40px 0}.item[_ngcontent-%COMP%]   figure[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   figure[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{border-radius:30px 30px 30px 0}.item[_ngcontent-%COMP%]   figcaption[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#0a1642;height:60px;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;overflow:hidden;-webkit-box-orient:vertical}.item[_ngcontent-%COMP%]   figcaption[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]:hover{color:#db9f3e}.item[_ngcontent-%COMP%]   figcaption[_ngcontent-%COMP%]   .rateBox[_ngcontent-%COMP%]{background:#ffa903;font-size:13px;border-radius:50px 50px 50px 0}"]})}}return s})();export{U as a};
